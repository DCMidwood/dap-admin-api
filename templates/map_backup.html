{% extends 'base.html' %}
{% set active_page = 'new_item' %}
{% block title %}Map! {% endblock %}

{% block content %}
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
<script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>

<div id="map" style="height: 250px;"></div>

<script type="text/javascript">
  // The first parameter are the coordinates of the center of the map
  // The second parameter is the zoom level
  var map = L.map('map').setView([{{coords.lat}}, {{coords.lon}}], 10);

  // {s}, {z}, {x} and {y} are placeholders for map tiles
  // {x} and {y} are the x/y of where you are on the map
  // {z} is the zoom level
  // {s} is the subdomain of cartodb
  var layer = L.tileLayer('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'
  });

  // Now add the layer onto the map
  map.addLayer(layer);

  // It even opens up a popup when you click it!
    L.marker([{{coords.lat}}, {{coords.lon}}]).addTo(map)
  .bindPopup("<strong>{{workpack.workpack}}</strong>").openPopup();

  // TO DO - Plot the extents
  //var bounds = [[53.912257, 27.581640], [53.902257, 27.561640]];
  //var rect = L.rectangle(bounds, {color: 'blue', weight: 1}).on('click', function (e) {
      // There event is event object
      // there e.type === 'click'
      // there e.lanlng === L.LatLng on map
      // there e.target.getLatLngs() - your rectangle coordinates
      // but e.target !== rect
      //console.info(e);
  //}).addTo(map);

</script>

{% endblock %}
